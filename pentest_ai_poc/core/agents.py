from __future__ import annotations

from dataclasses import dataclass
from typing import Any, Dict, Optional


@dataclass
class AgentResult:
    """
    子 AI 扫描结果统一结构。
    """

    name: str
    success: bool
    vuln: Optional[str] = None
    poc: Optional[str] = None
    details: Optional[str] = None
    raw_output: Optional[str] = None
    error: Optional[str] = None
    risk: Optional[str] = None  # 高 / 中 / 低
    report: Optional[str] = None  # 标准格式报告字符串（仅当 success=True 且 vuln 不为空时）
    report_filename: Optional[str] = None  # 保存的报告文件名（不含路径）


class BaseAgent:
    """
    所有子 AI 的基类，子类必须实现 run(context) -> AgentResult。
    """

    name: str = "base"

    def run(self, context: Dict[str, Any]) -> AgentResult:  # pragma: no cover - interface
        raise NotImplementedError

